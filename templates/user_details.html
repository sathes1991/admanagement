<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>User Details - {{ user.username }}</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="bg-light py-4">

<div class="container">
    <div class="d-flex justify-content-between align-items-center mb-4">
        <h2>User Details: {{ user.username }}</h2>
        <a href="{{ url_for('list_users') }}" class="btn btn-secondary">⬅ Back to Users</a>
    </div>

    {% with messages = get_flashed_messages(with_categories=true) %}
      {% if messages %}
        {% for category, message in messages %}
          <div class="alert alert-{{ category }} alert-dismissible fade show" role="alert">
            {{ message }}
            <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
          </div>
        {% endfor %}
      {% endif %}
    {% endwith %}

    <div class="card shadow-sm">
        <div class="card-body">
            <h5 class="card-title">Account Information</h5>
            <ul class="list-group list-group-flush">
                <li class="list-group-item"><strong>Username:</strong> {{ user.username }}</li>
                <li class="list-group-item"><strong>Display Name:</strong> {{ user.display_name }}</li>
                <li class="list-group-item"><strong>Email:</strong> {{ user.email }}</li>
                <li class="list-group-item"><strong>UID Number:</strong> {{ user.uid_number }}</li>
                <li class="list-group-item"><strong>GID Number:</strong> {{ user.gid_number }}</li>
                <li class="list-group-item"><strong>Account Status:</strong> 
                    {% if user.enabled %}
                        <span class="badge bg-success">Enabled</span>
                    {% else %}
                        <span class="badge bg-danger">Disabled</span>
                    {% endif %}
                </li>
                <li class="list-group-item">
                    <strong>Allowed Computers (Logon To):</strong>
                    {% if user.allowed_computers %}
                        {{ user.allowed_computers }}
                    {% else %}
                        <span class="text-muted">Any</span>
                    {% endif %}
                    <a href="{{ url_for('set_logon_to', username=user.username) }}" class="btn btn-sm btn-outline-dark float-end">
                        ✏️ Edit
                    </a>
                </li>
            </ul>
        </div>
    </div>

    <div class="mt-4 d-flex gap-2 flex-wrap">
        <form action="{{ url_for('reset_password', username=user.username) }}" method="get" class="d-inline">
            <button type="submit" class="btn btn-outline-warning btn-sm">🔒 Reset Password</button>
        </form>

        <form method="POST" action="{{ url_for('unlock_account', username=user.username) }}">
            <button type="submit" class="btn btn-info">🔓 Unlock Account</button>
        </form>

        {% if user.enabled %}
        <form method="POST" action="{{ url_for('disable_user', username=user.username) }}">
            <button type="submit" class="btn btn-outline-danger">🚫 Disable Account</button>
        </form>
        {% else %}
        <form method="POST" action="{{ url_for('enable_user', username=user.username) }}">
            <button type="submit" class="btn btn-success">✅ Enable Account</button>
        </form>
        {% endif %}

        <a href="{{ url_for('edit_user', username=user.username) }}" class="btn btn-primary">✏️ Edit User</a>

        <form method="POST" action="{{ url_for('delete_user', username=user.username) }}" onsubmit="return confirm('Are you sure you want to delete this user?');">
            <button type="submit" class="btn btn-danger">🗑️ Delete User</button>
        </form>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
